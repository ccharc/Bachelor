cos((24*pi)/8784*I(time(se2conskvart4[,1])))+
sin((104*pi)/8784*I(time(se2conskvart4[,1])))+
cos((104*pi)/8784*I(time(se2conskvart4[,1])))+
sin((732*pi)/8784*I(time(se2conskvart4[,1])))+
cos((732*pi)/8784*I(time(se2conskvart4[,1])))+
sin((17570*pi)/8784*I(time(se2conskvart4[,1])))+
cos((17570*pi)/8784*I(time(se2conskvart4[,1])))
)
scons= glm(data[,3] ~ time(data[,1]) +
I(time(data[,1])^2) +
sin((2*pi)/8784*I(time(data[,1]))) +
cos((2*pi)/8784*I(time(data[,1])))+
sin((4*pi)/8784*I(time(data[,1])))+
cos((4*pi)/8784*I(time(data[,1])))+
sin((8*pi)/8784*I(time(data[,1])))+
cos((8*pi)/8784*I(time(data[,1])))+
sin((24*pi)/8784*I(time(data[,1])))+
cos((24*pi)/8784*I(time(data[,1])))+
sin((104*pi)/8784*I(time(data[,1])))+
cos((104*pi)/8784*I(time(data[,1])))+
sin((732*pi)/8784*I(time(data[,1])))+
cos((732*pi)/8784*I(time(data[,1])))+
sin((17570*pi)/8784*I(time(data[,1])))+
cos((17570*pi)/8784*I(time(data[,1])))
)
summary(scons)
z_t = ts(scons$residuals)
plot.ts(z_t)
### SÃ¦son kvartal price
spricekvart1 = glm(se2pricekvart1[,2] ~ time(se2pricekvart1[,1]) +
I(time(se2pricekvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart1[,1])))
)
spricekvart2 = glm(se2pricekvart2[,2] ~ time(se2pricekvart2[,1]) +
I(time(se2pricekvart2[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart2[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart2[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart2[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart2[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart2[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart2[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart2[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart2[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart2[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart2[,1])))
)
spricekvart3 = glm(se2pricekvart3[,2] ~ time(se2pricekvart3[,1]) +
I(time(se2pricekvart3[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart3[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart3[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart3[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart3[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart3[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart3[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart3[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart3[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart3[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart3[,1])))
)
spricekvart4 = glm(se2pricekvart4[,2] ~ time(se2pricekvart4[,1]) +
I(time(se2pricekvart4[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart4[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart4[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart4[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart4[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart4[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart4[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart4[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart4[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart4[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart4[,1])))
)
sprice= glm(data[,2] ~ time(data[,1]) +
I(time(data[,1])^2) +
sin((2*pi)/8784*I(time(data[,1]))) +
cos((2*pi)/8784*I(time(data[,1])))+
sin((4*pi)/8784*I(time(data[,1])))+
cos((4*pi)/8784*I(time(data[,1])))+
sin((8*pi)/8784*I(time(data[,1])))+
cos((8*pi)/8784*I(time(data[,1])))+
sin((24*pi)/8784*I(time(data[,1])))+
cos((24*pi)/8784*I(time(data[,1])))+
sin((104*pi)/8784*I(time(data[,1])))+
cos((104*pi)/8784*I(time(data[,1])))+
sin((732*pi)/8784*I(time(data[,1])))+
cos((732*pi)/8784*I(time(data[,1])))+
sin((17570*pi)/8784*I(time(data[,1])))+
cos((17570*pi)/8784*I(time(data[,1])))
)
summary(sprice)
y_t = ts(sprice$residuals)
plot.ts(y_t)
X_t = data.frame(y_t,x_t, z_t)
model11 =VAR(X_t, ic = "AIC", lag.max = 20)
summary(model11)
# VAR Modeller kvart
# WIND
x_t1 = ts(swindkvart1$residuals)
x_t2 = ts(swindkvart2$residuals)
x_t3 = ts(swindkvart3$residuals)
x_t4 = ts(swindkvart4$residuals)
#CONS
z_t1 = ts(sconskvart1$residuals)
z_t2 = ts(sconskvart2$residuals)
z_t3 = ts(sconskvart3$residuals)
z_t4 = ts(sconskvart4$residuals)
# PRICE
y_t1 = ts(spricekvart1$residuals)
y_t2 = ts(spricekvart2$residuals)
y_t3 = ts(spricekvart3$residuals)
y_t4 = ts(spricekvart4$residuals)
# VAR MODEL
X_t1 = data.frame(y_t1,x_t1, z_t1)
X_t2 = data.frame(y_t2,x_t2, z_t2)
X_t3 = data.frame(y_t3,x_t3, z_t3)
X_t4 = data.frame(y_t4,x_t4, z_t4)
fit1 = VAR(X_t1, ic = "AIC", lag.max = 10)
fit2 = VAR(X_t2, ic = "AIC", lag.max = 10)
fit3 = VAR(X_t3, ic = "AIC", lag.max = 10)
fit4 = VAR(X_t4, ic = "AIC", lag.max = 10)
summary(fit1)
summary(fit2)
summary(fit3)
summary(fit4)
install.packages("sarima")
library("sarima", lib.loc="/Library/Frameworks/R.framework/Versions/3.6/Resources/library")
?sarima
sarima(x_t1)
arma(x_t1)
?auto.arima
auto.arima(x_t1, d=0, seasonal = TRUE)
seas_x1 = auto.arima(x_t1, d=0, seasonal = TRUE)
res_x1 = ts(seas_x1$residuals)
res_x1
plot.ts(res_x1)
acf(res_x1)
acf(x_t1)
seas_x1 = auto.arima(x_t1, d=0, seasonal = TRUE)
res_x1 = ts(seas_x1$residuals)
seas_y1 = auto.arima(y_t1, d=0, seasonal = TRUE)
res_y1 = ts(seas_y1$residuals)
seas_z1 = auto.arima(z_t1, d=0, seasonal = TRUE)
res_z1 = ts(seas_z1$residuals)
seas_Xt = data.frame(seas_y1, seas_x1, seas_z1)
seas_Xt = data.frame(res_y1, res_x1, res_z1)
seas_fit1 = VAR(Xt, ic = "AIC", lag.max = 10)
seas_fit1 = VAR(seas_Xt, ic = "AIC", lag.max = 10)
summary(seas_fit1)
library(readxl)
library(vars)
library(imputeTS)
library(forecast)
library(tseries)
library(stats)
library(strucchange)
library(tidyr)
#elprice15 = data.frame(read.csv("elspot-prices_2015_hourly_eur.csv",sep=";"))
elprice16 =  data.frame(read.csv("elspot-prices_2016_hourly_eur.csv",sep=";",dec=","))
#elprice17 = data.frame(read.csv("elspot-prices_2017_hourly_eur.csv",sep=";"))
#elprice18 = data.frame(read.csv("elspot-prices_2018_hourly_eur.csv",sep=";"))
#cons15 = data.frame(read.csv("consumption-se-areas_2015_hourly.csv",sep=";"))
cons16 = data.frame(read.csv("consumption-se-areas_2016_hourly.csv",sep=";"))
#cons17 = data.frame(read.csv("consumption-se-areas_2017_hourly.csv",sep=";"))
#cons18 = data.frame(read.csv("consumption-se-areas_2018_hourly.csv",sep=";"))
#wind15 = data.frame(read.csv("wind-power-se_2015_hourly.csv",sep=";"))
wind16 = data.frame(read.csv("wind-power-se_2016_hourly.csv",sep=";"))
#wind17 = data.frame(read.csv("wind-power-se_2017_hourly.csv",sep=";"))
#wind18 = data.frame(read.csv("wind-power-se_2018_hourly.csv",sep=";"))
#PRISER
#PRICE15 = elprice15[554:8763,4]
PRICE16 = elprice16[1:8784,5]
#PRICE17 = elprice17[3:8763,4]
#PRICE18 = elprice18[3:6290,4]
SE2price = data.frame(na.approx(c(PRICE16)))
#FORBRUG
#CONS15 = cons15[554:8763,3]
CONS16 = cons16[3:8786,4]
#CONS17 = cons17[3:8763,3]
#CONS18 = cons18[3:6290,3]
SE2cons = data.frame(na_interpolation(c(CONS16), option = "linear"))
#VINDPRODUKTION
#WIND15 = wind15[554:8763,3]
WIND16 = wind16[3:8786,4]
#WIND17 = wind17[3:8763,3]
#WIND18 = wind18[3:6290,3]
SE2wind = data.frame(na_interpolation(c(WIND16), option = "linear"))
#DATO
dato1 <- seq(c(ISOdate(2016,1,1,0)), by = "hours", length.out = 8784)
#DATA
data = data.frame(dato1,SE2price,SE2cons,SE2wind)
plot.ts(PRICE16)
plot.ts(CONS16)
plot.ts(WIND16)
### SARMA
# WIND
x_t1 = ts(swindkvart1$residuals)
x_t2 = ts(swindkvart2$residuals)
x_t3 = ts(swindkvart3$residuals)
x_t4 = ts(swindkvart4$residuals)
#CONS
z_t1 = ts(sconskvart1$residuals)
z_t2 = ts(sconskvart2$residuals)
z_t3 = ts(sconskvart3$residuals)
z_t4 = ts(sconskvart4$residuals)
# PRICE
y_t1 = ts(spricekvart1$residuals)
y_t2 = ts(spricekvart2$residuals)
y_t3 = ts(spricekvart3$residuals)
y_t4 = ts(spricekvart4$residuals)
acf(x_t1)
seas_x1 = auto.arima(x_t1, d=0, seasonal = TRUE)
res_x1 = ts(seas_x1$residuals)
seas_y1 = auto.arima(y_t1, d=0, seasonal = TRUE)
res_y1 = ts(seas_y1$residuals)
seas_z1 = auto.arima(z_t1, d=0, seasonal = TRUE)
res_z1 = ts(seas_z1$residuals)
seas_Xt = data.frame(res_y1, res_x1, res_z1)
seas_fit1 = VAR(seas_Xt, ic = "AIC", lag.max = 10)
summary(seas_fit1)
### SARMA
swindkvart1 = glm(se2windkvart1[,2] ~ time(se2windkvart1[,1]) +
I(time(se2windkvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2windkvart1[,1])))+
cos((8*pi)/8784*I(time(se2windkvart1[,1])))+
sin((24*pi)/8784*I(time(se2windkvart1[,1])))+
cos((24*pi)/8784*I(time(se2windkvart1[,1])))+
sin((104*pi)/8784*I(time(se2windkvart1[,1])))+
cos((104*pi)/8784*I(time(se2windkvart1[,1])))+
sin((732*pi)/8784*I(time(se2windkvart1[,1])))+
cos((732*pi)/8784*I(time(se2windkvart1[,1])))+
sin((17570*pi)/8784*I(time(se2windkvart1[,1])))+
cos((17570*pi)/8784*I(time(se2windkvart1[,1])))
)
sconskvart1 = glm(se2conskvart1[,2] ~ time(se2conskvart1[,1]) +
I(time(se2conskvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2conskvart1[,1])))+
cos((8*pi)/8784*I(time(se2conskvart1[,1])))+
sin((24*pi)/8784*I(time(se2conskvart1[,1])))+
cos((24*pi)/8784*I(time(se2conskvart1[,1])))+
sin((104*pi)/8784*I(time(se2conskvart1[,1])))+
cos((104*pi)/8784*I(time(se2conskvart1[,1])))+
sin((732*pi)/8784*I(time(se2conskvart1[,1])))+
cos((732*pi)/8784*I(time(se2conskvart1[,1])))+
sin((17570*pi)/8784*I(time(se2conskvart1[,1])))+
cos((17570*pi)/8784*I(time(se2conskvart1[,1])))
)
spricekvart1 = glm(se2pricekvart1[,2] ~ time(se2pricekvart1[,1]) +
I(time(se2pricekvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart1[,1])))
)
# WIND
x_t1 = ts(swindkvart1$residuals)
x_t2 = ts(swindkvart2$residuals)
x_t3 = ts(swindkvart3$residuals)
x_t4 = ts(swindkvart4$residuals)
#CONS
z_t1 = ts(sconskvart1$residuals)
z_t2 = ts(sconskvart2$residuals)
z_t3 = ts(sconskvart3$residuals)
z_t4 = ts(sconskvart4$residuals)
# PRICE
y_t1 = ts(spricekvart1$residuals)
y_t2 = ts(spricekvart2$residuals)
y_t3 = ts(spricekvart3$residuals)
y_t4 = ts(spricekvart4$residuals)
acf(x_t1)
seas_x1 = auto.arima(x_t1, d=0, seasonal = TRUE)
res_x1 = ts(seas_x1$residuals)
seas_y1 = auto.arima(y_t1, d=0, seasonal = TRUE)
res_y1 = ts(seas_y1$residuals)
seas_z1 = auto.arima(z_t1, d=0, seasonal = TRUE)
res_z1 = ts(seas_z1$residuals)
seas_Xt = data.frame(res_y1, res_x1, res_z1)
seas_fit1 = VAR(seas_Xt, ic = "AIC", lag.max = 10)
summary(seas_fit1)
swindkvart1 = glm(se2windkvart1[,2] ~ time(se2windkvart1[,1]) +
I(time(se2windkvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2windkvart1[,1])))+
cos((8*pi)/8784*I(time(se2windkvart1[,1])))+
sin((24*pi)/8784*I(time(se2windkvart1[,1])))+
cos((24*pi)/8784*I(time(se2windkvart1[,1])))+
sin((104*pi)/8784*I(time(se2windkvart1[,1])))+
cos((104*pi)/8784*I(time(se2windkvart1[,1])))+
sin((732*pi)/8784*I(time(se2windkvart1[,1])))+
cos((732*pi)/8784*I(time(se2windkvart1[,1])))+
sin((17570*pi)/8784*I(time(se2windkvart1[,1])))+
cos((17570*pi)/8784*I(time(se2windkvart1[,1])))
)
### SARMA
### SÃ¦son kvartal price
se2pricekvart1 = data[1:2182,1:2]
se2pricekvart2 = data[2183:4366,1:2]
se2pricekvart3 = data[4367:6574,1:2]
se2pricekvart4 = data[6575:8784,1:2]
### SÃ¦son kvartal cons
se2conskvart1 = data[1:2182,c(1,3)]
se2conskvart2 = data[2183:4366,c(1,3)]
se2conskvart3 = data[4367:6574,c(1,3)]
se2conskvart4 = data[6575:8784,c(1,3)]
### SÃ¦son kvartal wind
se2windkvart1 = data[1:2182,c(1,4)]
se2windkvart2 = data[2183:4366,c(1,4)]
se2windkvart3 = data[4367:6574,c(1,4)]
se2windkvart4 = data[6575:8784,c(1,4)]
swindkvart1 = glm(se2windkvart1[,2] ~ time(se2windkvart1[,1]) +
I(time(se2windkvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2windkvart1[,1])))+
cos((8*pi)/8784*I(time(se2windkvart1[,1])))+
sin((24*pi)/8784*I(time(se2windkvart1[,1])))+
cos((24*pi)/8784*I(time(se2windkvart1[,1])))+
sin((104*pi)/8784*I(time(se2windkvart1[,1])))+
cos((104*pi)/8784*I(time(se2windkvart1[,1])))+
sin((732*pi)/8784*I(time(se2windkvart1[,1])))+
cos((732*pi)/8784*I(time(se2windkvart1[,1])))+
sin((17570*pi)/8784*I(time(se2windkvart1[,1])))+
cos((17570*pi)/8784*I(time(se2windkvart1[,1])))
)
sconskvart1 = glm(se2conskvart1[,2] ~ time(se2conskvart1[,1]) +
I(time(se2conskvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2conskvart1[,1])))+
cos((8*pi)/8784*I(time(se2conskvart1[,1])))+
sin((24*pi)/8784*I(time(se2conskvart1[,1])))+
cos((24*pi)/8784*I(time(se2conskvart1[,1])))+
sin((104*pi)/8784*I(time(se2conskvart1[,1])))+
cos((104*pi)/8784*I(time(se2conskvart1[,1])))+
sin((732*pi)/8784*I(time(se2conskvart1[,1])))+
cos((732*pi)/8784*I(time(se2conskvart1[,1])))+
sin((17570*pi)/8784*I(time(se2conskvart1[,1])))+
cos((17570*pi)/8784*I(time(se2conskvart1[,1])))
)
spricekvart1 = glm(se2pricekvart1[,2] ~ time(se2pricekvart1[,1]) +
I(time(se2pricekvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart1[,1])))
)
# WIND
x_t1 = ts(swindkvart1$residuals)
x_t2 = ts(swindkvart2$residuals)
x_t3 = ts(swindkvart3$residuals)
x_t4 = ts(swindkvart4$residuals)
#CONS
z_t1 = ts(sconskvart1$residuals)
z_t2 = ts(sconskvart2$residuals)
z_t3 = ts(sconskvart3$residuals)
z_t4 = ts(sconskvart4$residuals)
# PRICE
y_t1 = ts(spricekvart1$residuals)
y_t2 = ts(spricekvart2$residuals)
y_t3 = ts(spricekvart3$residuals)
y_t4 = ts(spricekvart4$residuals)
acf(x_t1)
seas_x1 = auto.arima(x_t1, d=0, seasonal = TRUE)
res_x1 = ts(seas_x1$residuals)
seas_y1 = auto.arima(y_t1, d=0, seasonal = TRUE)
res_y1 = ts(seas_y1$residuals)
seas_z1 = auto.arima(z_t1, d=0, seasonal = TRUE)
res_z1 = ts(seas_z1$residuals)
seas_Xt = data.frame(res_y1, res_x1, res_z1)
seas_fit1 = VAR(seas_Xt, ic = "AIC", lag.max = 10)
summary(seas_fit1)
library(readxl)
library(vars)
library(imputeTS)
library(forecast)
library(tseries)
library(stats)
library(strucchange)
library(tidyr)
#elprice15 = data.frame(read.csv("elspot-prices_2015_hourly_eur.csv",sep=";"))
elprice16 =  data.frame(read.csv("elspot-prices_2016_hourly_eur.csv",sep=";",dec=","))
#elprice17 = data.frame(read.csv("elspot-prices_2017_hourly_eur.csv",sep=";"))
#elprice18 = data.frame(read.csv("elspot-prices_2018_hourly_eur.csv",sep=";"))
#cons15 = data.frame(read.csv("consumption-se-areas_2015_hourly.csv",sep=";"))
cons16 = data.frame(read.csv("consumption-se-areas_2016_hourly.csv",sep=";"))
#cons17 = data.frame(read.csv("consumption-se-areas_2017_hourly.csv",sep=";"))
#cons18 = data.frame(read.csv("consumption-se-areas_2018_hourly.csv",sep=";"))
#wind15 = data.frame(read.csv("wind-power-se_2015_hourly.csv",sep=";"))
wind16 = data.frame(read.csv("wind-power-se_2016_hourly.csv",sep=";"))
#wind17 = data.frame(read.csv("wind-power-se_2017_hourly.csv",sep=";"))
#wind18 = data.frame(read.csv("wind-power-se_2018_hourly.csv",sep=";"))
#PRISER
#PRICE15 = elprice15[554:8763,4]
PRICE16 = elprice16[1:8784,5]
#PRICE17 = elprice17[3:8763,4]
#PRICE18 = elprice18[3:6290,4]
SE2price = data.frame(na.approx(c(PRICE16)))
#FORBRUG
#CONS15 = cons15[554:8763,3]
CONS16 = cons16[3:8786,4]
#CONS17 = cons17[3:8763,3]
#CONS18 = cons18[3:6290,3]
SE2cons = data.frame(na_interpolation(c(CONS16), option = "linear"))
#VINDPRODUKTION
#WIND15 = wind15[554:8763,3]
WIND16 = wind16[3:8786,4]
#WIND17 = wind17[3:8763,3]
#WIND18 = wind18[3:6290,3]
SE2wind = data.frame(na_interpolation(c(WIND16), option = "linear"))
#DATO
dato1 <- seq(c(ISOdate(2016,1,1,0)), by = "hours", length.out = 8784)
#DATA
data = data.frame(dato1,SE2price,SE2cons,SE2wind)
plot.ts(PRICE16)
plot.ts(CONS16)
plot.ts(WIND16)
### SARMA
### SÃ¦son kvartal price
se2pricekvart1 = data[1:2182,1:2]
se2pricekvart2 = data[2183:4366,1:2]
se2pricekvart3 = data[4367:6574,1:2]
se2pricekvart4 = data[6575:8784,1:2]
### SÃ¦son kvartal cons
se2conskvart1 = data[1:2182,c(1,3)]
se2conskvart2 = data[2183:4366,c(1,3)]
se2conskvart3 = data[4367:6574,c(1,3)]
se2conskvart4 = data[6575:8784,c(1,3)]
### SÃ¦son kvartal wind
se2windkvart1 = data[1:2182,c(1,4)]
se2windkvart2 = data[2183:4366,c(1,4)]
se2windkvart3 = data[4367:6574,c(1,4)]
se2windkvart4 = data[6575:8784,c(1,4)]
swindkvart1 = glm(se2windkvart1[,2] ~ time(se2windkvart1[,1]) +
I(time(se2windkvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2windkvart1[,1])))+
cos((8*pi)/8784*I(time(se2windkvart1[,1])))+
sin((24*pi)/8784*I(time(se2windkvart1[,1])))+
cos((24*pi)/8784*I(time(se2windkvart1[,1])))+
sin((104*pi)/8784*I(time(se2windkvart1[,1])))+
cos((104*pi)/8784*I(time(se2windkvart1[,1])))+
sin((732*pi)/8784*I(time(se2windkvart1[,1])))+
cos((732*pi)/8784*I(time(se2windkvart1[,1])))+
sin((17570*pi)/8784*I(time(se2windkvart1[,1])))+
cos((17570*pi)/8784*I(time(se2windkvart1[,1])))
)
sconskvart1 = glm(se2conskvart1[,2] ~ time(se2conskvart1[,1]) +
I(time(se2conskvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2conskvart1[,1])))+
cos((8*pi)/8784*I(time(se2conskvart1[,1])))+
sin((24*pi)/8784*I(time(se2conskvart1[,1])))+
cos((24*pi)/8784*I(time(se2conskvart1[,1])))+
sin((104*pi)/8784*I(time(se2conskvart1[,1])))+
cos((104*pi)/8784*I(time(se2conskvart1[,1])))+
sin((732*pi)/8784*I(time(se2conskvart1[,1])))+
cos((732*pi)/8784*I(time(se2conskvart1[,1])))+
sin((17570*pi)/8784*I(time(se2conskvart1[,1])))+
cos((17570*pi)/8784*I(time(se2conskvart1[,1])))
)
spricekvart1 = glm(se2pricekvart1[,2] ~ time(se2pricekvart1[,1]) +
I(time(se2pricekvart1[,1])^2) +
sin((8*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((8*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((24*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((24*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((104*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((104*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((732*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((732*pi)/8784*I(time(se2pricekvart1[,1])))+
sin((17570*pi)/8784*I(time(se2pricekvart1[,1])))+
cos((17570*pi)/8784*I(time(se2pricekvart1[,1])))
)
# WIND
x_t1 = ts(swindkvart1$residuals)
x_t2 = ts(swindkvart2$residuals)
x_t3 = ts(swindkvart3$residuals)
x_t4 = ts(swindkvart4$residuals)
#CONS
z_t1 = ts(sconskvart1$residuals)
z_t2 = ts(sconskvart2$residuals)
z_t3 = ts(sconskvart3$residuals)
z_t4 = ts(sconskvart4$residuals)
# PRICE
y_t1 = ts(spricekvart1$residuals)
y_t2 = ts(spricekvart2$residuals)
y_t3 = ts(spricekvart3$residuals)
y_t4 = ts(spricekvart4$residuals)
acf(x_t1)
seas_x1 = auto.arima(x_t1, d=0, seasonal = TRUE)
res_x1 = ts(seas_x1$residuals)
seas_y1 = auto.arima(y_t1, d=0, seasonal = TRUE)
res_y1 = ts(seas_y1$residuals)
seas_z1 = auto.arima(z_t1, d=0, seasonal = TRUE)
res_z1 = ts(seas_z1$residuals)
seas_Xt = data.frame(res_y1, res_x1, res_z1)
seas_fit1 = VAR(seas_Xt, ic = "AIC", lag.max = 10)
summary(seas_fit1)
?sarima
